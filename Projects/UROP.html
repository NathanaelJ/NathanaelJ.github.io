
<!DOCTYPE html>
<html lang="en">
        
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="../styles.css" />
        <title>Nathanael Jenkins | UROP</title>
    </head>


    <body>
        <script src="../../java.js"></script>
        <div w3-include-html="../../header.html"></div>
        <script>w3.includeHTML();</script>
        
        <main class="site-main">
            
            <!--    INTRO    -->
            <h1 class="wrapper">GPU Parallelisation of a 2D Navier-Stokes Solver</h1>
            <h2 class="wrapper">'Undergraduate Research Opportunity' at Imperial College London<br/><br/></h2>
            <p class="wrapper">Under the supervision of <a href="https://www.turbulencesimulation.com">Sylvain Laizet</a>, I undertook a research project exploring parallelism in computational fluid dynamics. In particular, parallelisation using <a href="https://github.com/illuhad/hipSYCL">hipSYCL</a> and <a href="https://www.openmp.org">OpenMP</a> was explored, with a focus on high performance heterogeneous computing and the use of GPU devices.<br/><br/>Conventional computer code runs serially using a single thread. This means that each task is executed sequentially as the program runs. However, for computational fluid dynamics programs (and other software), many tasks are independent of one another and often involve making repeated calculations on elements in large arrays. These tasks can be run in parallel (simultaneously) on several processors, speeding up the program. 'Traditional' high performance computing achieves this using CPU parallelism, launching simulations on tens, hundreds, or even thousands of computational cores at once.<br/><br/></p>
            
            <!--    THE SOLVER    -->
            <hr width="50%" size="1px" color="#555" z-index="1">
            <h3 class="wrapper">The Solver</h3>
            <p class="wrapper">The primary project deliverable was a short finite-difference 2D Navier-Stokes solver used to simulate flow over a heat exchanger based on circular cylinders. Code was initially written in Fortran90, using a computational domain of 129x129 elements. A sample of the solver result is shown in figure 1. <b>This project is still ongoing. Check back soon for updates!</b><br/><br/></p>
            <picture>
                <source
                    srcset="Proj4/flow_Dark.gif"
                    media="(prefers-color-scheme: dark)" class="wrapper" alt="Flow gif">
                <img src="Proj4/flow.gif" class="wrapper" style="width: 40vw; margin-left: 20vw;" alt="Flow gif">
            </picture>
            <figcaption class="wrapper">Simulated flow over a heat exchanger at Re=200 (coloured by periodicity)</figcaption>
            <p class="wrapper"><br/>The original code was single-threaded, but the majority of computation took place inside of highly parallelisable loops. To take advantage of these, a parallelisation framework was to be implemented so that the code could be run in the most efficient way possible on a range of devices. Fortran can be used with OpenMP, which is capable of running in parallel on heterogeneous systems (version 5+), although the language is becoming less popular and less widely supported. An new alternative to OpenMP heterogeneous computing is Khronos Group's SYCL framework, which is growing in popularity.<br/><br/>To implement SYCL, a popular heterogeneous parallelisation framework, either C or C++ code is needed. For this reason, the solver was 'translated' into C++. With some minor changes to data types in C++, the two programs were tested to confirm that they returned identical results. Initially, C++ multidimensional arrays were used, although these are stored in stack memory, which led to significant issues when testing with larger computational domains. For this reason, a pointer-based method was used to store arrays in heap instead. This made parallelisation easier, as it simplified the process of using USM, which was found to perform better than buffers in this case.<br/><br/></p>
            <picture>
                <img src="Proj4/comp.png" class="wrapper" alt="Comparison of Fortran and C++ functions">
            </picture>
            <figcaption class="wrapper">Example of original Fortran code against 'translated' C++ code</figcaption>

            <!--    PARALLELISATION    -->
            <hr width="50%" size="1px" color="#555" z-index="1">
            <h3 class="wrapper">SYCL</h3>
            <p class="wrapper">Details coming soon...<br/><br/></p>

            <!--    REPORT    -->
            <hr width="50%" size="1px" color="#555" z-index="1">
            <h3 class="wrapper">Project Report</h3>
            <p class="wrapper"><a href="Proj4/UROP_Report.pdf" download>Click here to download a copy</a><br/><br/></p>
            <div class="iframewindow">
                <iframe class="iframepdf" src="Proj4/UROP_Report.pdf"></iframe>
            </div>
            <p class="wrapper"><br/>Please cite this project:<br/>Jenkins, N. (2021). <i>GPU Parallelisation of a 2D Navier-Stokes Solver</i> [pdf] London: Imperial College London. Available at: http://nathanaelj.github.io/Projects/UROP [Accessed: <script> document.write(new Date().toLocaleDateString()); </script>]<br/><br/></p>
            <p class="wrapper"><a href="../Projects.html">Check out more of my projects</a><br/><br/></p>
        </main>
        
        <script src="../../java.js"></script>
        <div w3-include-html="../../footer.html"></div>
        <script>w3.includeHTML();</script>
    </body>
    
</html>
